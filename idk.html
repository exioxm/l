<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CYBER DRIFT 2025: OMNI</title>
    <style>
        @import url('fonts.googleapis.com');
        body { margin: 0; background: #000; overflow: hidden; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: 'Orbitron', sans-serif; color: #fff; }
        #core { position: relative; width: 480px; height: 850px; background: #000; border: 1px solid #1a1a1a; overflow: hidden; box-shadow: 0 0 100px rgba(0, 255, 255, 0.1); }
        canvas { display: block; filter: contrast(1.1) saturate(1.3); cursor: none; }
        .ui-over { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; background: radial-gradient(circle, rgba(0,20,30,0.95) 0%, rgba(0,0,0,1) 100%); transition: 0.8s cubic-bezier(0.16, 1, 0.3, 1); backdrop-filter: blur(15px); }
        .hidden { opacity: 0; pointer-events: none; transform: scale(1.1) translateY(20px); }
        .title { font-size: 55px; font-weight: 900; letter-spacing: -2px; background: linear-gradient(to bottom, #fff 30%, #0ff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 20px #0ff); margin: 0; }
        .zed { font-size: 10px; color: #444; letter-spacing: 8px; margin-bottom: 10px; }
        .btn { padding: 20px 40px; background: rgba(0,255,255,0.05); border: 1px solid #0ff; color: #0ff; font-family: 'Orbitron'; cursor: pointer; transition: 0.3s; font-size: 14px; letter-spacing: 4px; width: 320px; margin: 10px; text-transform: uppercase; }
        .btn:hover { background: #0ff; color: #000; box-shadow: 0 0 50px #0ff; transform: translateY(-3px); }
        #hud { position: absolute; top: 30px; left: 30px; right: 30px; display: flex; justify-content: space-between; z-index: 50; pointer-events: none; }
        .hud-v { border-left: 4px solid #0ff; padding-left: 15px; }
        .hud-v div { font-size: 10px; color: #066; }
        .hud-v span { font-size: 22px; font-weight: 900; color: #0ff; text-shadow: 0 0 10px #0ff; }
        .dbg { position: absolute; bottom: 15px; left: 15px; font-size: 10px; color: #111; cursor: pointer; }
    </style>
</head>
<body>

<div id="core">
    <canvas id="stage"></canvas>
    <div id="hud" class="hidden">
        <div class="hud-v"><div>DISTANCE</div><span id="ui-dist">0</span> <small style="font-size:10px">FT</small></div>
        <div class="hud-v"><div>CREDITS</div>$<span id="ui-cash">0.00</span></div>
    </div>

    <div id="menu-main" class="ui-over">
        <div class="zed">ZED PRODUCTIONS</div>
        <h1 class="title">CYBER DRIFT</h1>
        <button class="btn" onclick="initCore(); showModes();">ENGAGE NEURAL LINK</button>
        <div class="dbg" onclick="openD()">[D]</div>
    </div>

    <div id="menu-modes" class="ui-over hidden">
        <button class="btn" onclick="launch('NORMAL')">STREET_LEVEL</button>
        <button class="btn" onclick="launch('WANTED')">PURSUIT_LVL</button>
        <button class="btn" onclick="launch('JAM')">GRIDLOCK_X</button>
        <button class="btn" onclick="location.reload()" style="border:none; color:#333; font-size:10px;">REBOOT_SYSTEM</button>
    </div>

    <div id="menu-admin" class="ui-over hidden">
        <button class="btn" style="border-color:#f0f; color:#f0f;" onclick="auth()">CMD_OVERRIDE</button>
        <button class="btn" onclick="closeD()">BACK</button>
    </div>
</div>

<script>
/** ðŸ”Š OMNI-AUDIO ENGINE **/
let au, engine, hum;
function initCore() {
    if (au) return;
    au = new (window.AudioContext || window.webkitAudioContext)();
    engine = au.createOscillator();
    hum = au.createGain();
    engine.type = 'sawtooth';
    engine.frequency.setValueAtTime(45, au.currentTime);
    hum.gain.setValueAtTime(0.04, au.currentTime);
    engine.connect(hum); hum.connect(au.destination);
    engine.start();
}
function sfx(f, t, d, v) {
    if(!au) return;
    const o = au.createOscillator(), g = au.createGain();
    o.type = t; o.frequency.setValueAtTime(f, au.currentTime);
    o.frequency.exponentialRampToValueAtTime(20, au.currentTime + d);
    g.gain.setValueAtTime(v, au.currentTime);
    g.gain.linearRampToValueAtTime(0, au.currentTime + d);
    o.connect(g); g.connect(au.destination);
    o.start(); o.stop(au.currentTime + d);
}

/** ðŸŽï¸ OMNI-GAME ENGINE **/
const cv = document.getElementById('stage'), ct = cv.getContext('2d');
cv.width = 480; cv.height = 850;

let st = 'MENU', md = '', fr = 0, sp = 12, dst = 0, csh = 0;
let px = 218, tx = 218, cars = [];
const CW = 44, CH = 88;

const get = i => document.getElementById(i);
const showModes = () => { get('menu-main').classList.add('hidden'); get('menu-modes').classList.remove('hidden'); }
const openD = () => { get('menu-main').classList.add('hidden'); get('menu-admin').classList.remove('hidden'); }
const closeD = () => { get('menu-admin').classList.add('hidden'); get('menu-main').classList.remove('hidden'); }
function auth() { if(prompt("AUTH_CODE:") === "test") { initCore(); launch('ADMIN'); } }

function launch(m) {
    md = m; st = 'PLAY'; dst = 0; fr = 0; sp = (m==='ADMIN'?22:(m==='JAM'?7:12));
    cars = []; document.querySelectorAll('.ui-over').forEach(e => e.classList.add('hidden'));
    get('hud').classList.remove('hidden');
}

window.addEventListener('mousemove', e => {
    const r = cv.getBoundingClientRect();
    tx = e.clientX - r.left - CW/2;
});

function spawn() {
    cars.push({
        x: Math.random() * (cv.width - 70) + 15,
        y: -200,
        c: `hsl(${Math.random()*360}, 60%, 45%)`,
        v: 0.75 + Math.random() * 0.45
    });
}

function update() {
    if(st !== 'PLAY') return;
    fr++; dst += sp * 0.12; csh += (sp * 0.00015); sp += 0.0025;
    px += (tx - px) * 0.22;
    px = Math.max(20, Math.min(cv.width - CW - 20, px));

    if(engine) engine.frequency.setTargetAtTime(45 + (sp * 2.5), au.currentTime, 0.1);

    if(fr % Math.max(6, Math.floor(35 - sp/1.8)) === 0) spawn();

    cars.forEach((c, i) => {
        c.y += sp * c.v;
        if(c.y > 680 && c.y < 695) sfx(200, 'sine', 0.15, 0.015);
        if (px < c.x + CW - 6 && px + CW > c.x + 6 && 700 < c.y + CH - 12 && 700 + CH > c.y + 12) {
            st = 'DEAD';
            sfx(80, 'sawtooth', 2, 0.4);
            setTimeout(() => location.reload(), 2000);
        }
        if(c.y > cv.height + 150) cars.splice(i, 1);
    });

    get('ui-dist').innerText = Math.floor(dst);
    get('ui-cash').innerText = csh.toFixed(2);
}

function drawV(x, y, col, isP) {
    ct.save();
    ct.translate(x, y);
    // Shadow
    ct.fillStyle = 'rgba(0,0,0,0.5)';
    ct.beginPath(); ct.roundRect(8, 10, CW, CH, 12); ct.fill();
    // Body + Metallic Shine
    const g = ct.createLinearGradient(0, 0, CW, 0);
    g.addColorStop(0, col); g.addColorStop(0.5, '#fff'); g.addColorStop(1, col);
    ct.fillStyle = g;
    ct.beginPath(); ct.roundRect(0, 0, CW, CH, 10); ct.fill();
    // Windshield
    ct.fillStyle = '#050505';
    ct.beginPath(); ct.roundRect(5, 18, CW-10, 32, 5); ct.fill();
    // Glass Highlight
    ct.fillStyle = 'rgba(255,255,255,0.15)';
    ct.fillRect(8, 22, 6, 20);
    // Lights
    if(isP) {
        ct.shadowBlur = 30; ct.shadowColor = '#0ff'; ct.fillStyle = '#fff';
        ct.fillRect(4, -4, 14, 6); ct.fillRect(CW-18, -4, 14, 6);
    } else {
        ct.fillStyle = '#f00';
        ct.fillRect(4, CH-2, 14, 5); ct.fillRect(CW-18, CH-2, 14, 5);
    }
    ct.restore();
}

function draw() {
    ct.fillStyle = '#020206'; ct.fillRect(0,0,cv.width,cv.height);
    // Road Grid Motion
    ct.strokeStyle = '#08081a'; ct.lineWidth = 2;
    for(let i=0; i<cv.width; i+=96) { ct.beginPath(); ct.moveTo(i, 0); ct.lineTo(i, cv.height); ct.stroke(); }
    
    ct.setLineDash([40, 60]);
    ct.lineDashOffset = -fr * sp;
    ct.strokeStyle = '#121225';
    for(let i=96; i<cv.width; i+=96) { ct.beginPath(); ct.moveTo(i, 0); ct.lineTo(i, cv.height); ct.stroke(); }
    ct.setLineDash([]);

    if(st === 'PLAY' || st === 'DEAD') {
        cars.forEach(c => drawV(c.x, c.y, c.c, false));
        if(st !== 'DEAD') drawV(px, 700, '#fff', true);
        else {
            // Explosion Particles
            for(let i=0; i<10; i++){
                ct.fillStyle = '#f0f';
                ct.fillRect(px+Math.random()*CW, 700+Math.random()*CH, 5, 5);
            }
        }
    }
}

function loop() { update(); draw(); requestAnimationFrame(loop); }
loop();
</script>
</body>
</html>
