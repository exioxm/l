<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Nitro Racer: Apex Shapes</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }
        canvas { background: #020205; border: 2px solid #00f2ff; box-shadow: 0 0 50px rgba(0, 242, 255, 0.4); cursor: crosshair; }
        #ui { position: absolute; top: 30px; width: 400px; display: flex; justify-content: space-between; color: #fff; pointer-events: none; }
        .label { font-size: 10px; color: #00f2ff; margin-bottom: 2px; text-transform: uppercase; }
        .val { font-size: 22px; font-weight: 900; text-shadow: 0 0 10px #00f2ff; font-family: 'Courier New', Courier, monospace; }
    </style>
</head>
<body>
    <div id="ui">
        <div><div class="label">Distance</div><div class="val" id="score">0</div></div>
        <div><div class="label">Speed</div><div class="val" id="speedDisplay">0</div></div>
    </div>
    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreVal = document.getElementById("score");
    const speedVal = document.getElementById("speedDisplay");

    canvas.width = 440;
    canvas.height = 750;

    let score = 0;
    let speed = 9;
    let frames = 0;
    let shake = 0;
    let enemies = [];
    let speedLines = [];

    const player = { x: 220, y: 580, w: 44, h: 88, color: "#00f2ff", targetX: 220 };

    window.addEventListener("mousemove", (e) => {
        const rect = canvas.getBoundingClientRect();
        player.targetX = e.clientX - rect.left - player.w / 2;
    });

    // Drawing a sleeker, aerodynamic shape instead of a box
    function drawFuturisticCar(x, y, w, h, color, isPlayer) {
        ctx.save();
        if(shake > 0) ctx.translate(Math.random()*shake - shake/2, Math.random()*shake - shake/2);
        
        ctx.shadowBlur = 20;
        ctx.shadowColor = color;
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;

        // MAIN BODY SHAPE (Polygon)
        ctx.beginPath();
        if(isPlayer) {
            // Player: Sleek Supercar Shape
            ctx.moveTo(x + w/2, y); // Nose
            ctx.lineTo(x + w, y + h*0.3); // Right Front
            ctx.lineTo(x + w*0.8, y + h*0.5); // Mid-in
            ctx.lineTo(x + w, y + h*0.8); // Right Rear
            ctx.lineTo(x + w*0.1, y + h*0.8); // Left Rear
            ctx.lineTo(x + w*0.2, y + h*0.5); // Mid-in Left
            ctx.lineTo(x, y + h*0.3); // Left Front
        } else {
            // Enemy: Aggressive Interceptor Shape
            ctx.moveTo(x + w*0.2, y);
            ctx.lineTo(x + w*0.8, y);
            ctx.lineTo(x + w, y + h*0.4);
            ctx.lineTo(x + w*0.9, y + h);
            ctx.lineTo(x + w*0.1, y + h);
            ctx.lineTo(x, y + h*0.4);
        }
        ctx.closePath();
        
        ctx.fillStyle = "#050505";
        ctx.fill();
        ctx.stroke();

        // COCKPIT GLOW
        ctx.fillStyle = isPlayer ? "rgba(0, 242, 255, 0.4)" : "rgba(255, 0, 85, 0.4)";
        ctx.beginPath();
        ctx.ellipse(x + w/2, y + h*0.4, w*0.25, h*0.15, 0, 0, Math.PI*2);
        ctx.fill();

        // REAR SPOILER (Only for Player)
        if(isPlayer) {
            ctx.strokeRect(x, y + h*0.85, w, 4);
            // Engine Flame
            if(frames % 4 === 0) {
                ctx.fillStyle = "#ff0055";
                ctx.fillRect(x + w*0.4, y + h, w*0.2, Math.random()*15);
            }
        }
        ctx.restore();
    }

    function update() {
        frames++;
        score += Math.floor(speed / 3);
        scoreVal.innerText = score.toLocaleString();
        speedVal.innerText = Math.floor(speed * 18) + " KM/H";

        if(shake > 0) shake *= 0.85;

        // Smooth Movement
        player.x += (player.targetX - player.x) * 0.15;
        player.x = Math.max(25, Math.min(canvas.width - player.w - 25, player.x));

        // Speed Lines (Visual Velocity)
        if(frames % 5 === 0) {
            speedLines.push({x: Math.random()*canvas.width, y: -20, h: Math.random()*30+10});
        }
        speedLines.forEach((l, i) => {
            l.y += speed * 2;
            if(l.y > canvas.height) speedLines.splice(i, 1);
        });

        // Spawn Enemies
        if (frames % Math.max(12, 45 - Math.floor(speed)) === 0) {
            enemies.push({ 
                x: 40 + Math.random() * (canvas.width - 120), 
                y: -150, 
                color: (frames % 100 === 0) ? "#39ff14" : "#ff0055" 
            });
        }

        enemies.forEach((e, i) => {
            e.y += speed + 4;
            if(e.y > canvas.height) enemies.splice(i, 1);

            // Precision Collision Detection
            if (player.x < e.x + 40 && player.x + player.w > e.x + 4 &&
                player.y < e.y + 80 && player.y + player.h > e.y + 4) {
                gameOver();
            }
        });

        if(score % 800 === 0) speed += 0.3;
    }

    function draw() {
        ctx.fillStyle = "rgba(2, 2, 8, 0.4)"; // Trail effect
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Moving Perspective Road
        ctx.strokeStyle = "rgba(0, 242, 255, 0.1)";
        ctx.lineWidth = 1;
        for(let i = 0; i <= 10; i++) {
            let x = (i * canvas.width/10);
            ctx.beginPath();
            ctx.moveTo(x, 0);
            ctx.lineTo(x, canvas.height);
            ctx.stroke();
        }

        // Speed Lines
        ctx.strokeStyle = "rgba(255, 255, 255, 0.15)";
        speedLines.forEach(l => {
            ctx.beginPath();
            ctx.moveTo(l.x, l.y);
            ctx.lineTo(l.x, l.y + l.h);
            ctx.stroke();
        });

        // Draw Entities
        enemies.forEach(e => drawFuturisticCar(e.x, e.y, 44, 88, e.color, false));
        drawFuturisticCar(player.x, player.y, player.w, player.h, player.color, true);

        update();
        requestAnimationFrame(draw);
    }

    function gameOver() {
        shake = 30;
        setTimeout(() => {
            alert("SYSTEM OVERRIDE: CRASH DETECTED\nSCORE: " + score);
            location.reload();
        }, 50);
    }

    draw();
</script>
</body>
</html>
