<!DOCTYPE html>
<html>
<head>
    <title>Precision Parking 2025</title>
    <style>
        body { margin: 0; background: #222; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Arial; }
        canvas { background: #444; border: 5px solid #666; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        #info { position: absolute; top: 20px; color: white; text-align: center; }
    </style>
</head>
<body>
    <div id="info">Use ARROW KEYS to steer and park in the YELLOW zone!<br>Damage: <span id="damage">0</span>%</div>
    <canvas id="parkCanvas"></canvas>

<script>
    const canvas = document.getElementById("parkCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 800; canvas.height = 600;

    const car = {
        x: 100, y: 100, angle: 0, speed: 0, 
        accel: 0.2, friction: 0.95, turnSpeed: 0.05,
        w: 40, h: 20, damage: 0
    };

    const target = { x: 650, y: 450, w: 60, h: 40 };
    const walls = [
        { x: 0, y: 0, w: 800, h: 20 },      // Top
        { x: 0, y: 580, w: 800, h: 20 },    // Bottom
        { x: 300, y: 200, w: 200, h: 200 }  // Central Obstacle
    ];

    const keys = {};
    window.addEventListener("keydown", e => keys[e.code] = true);
    window.addEventListener("keyup", e => keys[e.code] = false);

    function update() {
        // Steering Logic
        if (keys["ArrowUp"]) car.speed += car.accel;
        if (keys["ArrowDown"]) car.speed -= car.accel;
        
        // Only turn if moving
        if (Math.abs(car.speed) > 0.1) {
            const dir = car.speed > 0 ? 1 : -1;
            if (keys["ArrowLeft"]) car.angle -= car.turnSpeed * dir;
            if (keys["ArrowRight"]) car.angle += car.turnSpeed * dir;
        }

        car.speed *= car.friction;
        car.x += Math.cos(car.angle) * car.speed;
        car.y += Math.sin(car.angle) * car.speed;

        // Simple Wall Collision
        walls.forEach(w => {
            if (car.x > w.x && car.x < w.x + w.w && car.y > w.y && car.y < w.y + w.h) {
                car.speed = -car.speed * 1.5; // Bounce
                car.damage = Math.min(100, car.damage + 5);
                document.getElementById("damage").innerText = car.damage;
            }
        });

        // Win Condition
        if (car.x > target.x && car.x < target.x + target.w && 
            car.y > target.y && car.y < target.y + target.h && 
            Math.abs(car.speed) < 0.1) {
            alert("Perfectly Parked!");
            location.reload();
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw Target Zone
        ctx.fillStyle = "rgba(255, 255, 0, 0.3)";
        ctx.fillRect(target.x, target.y, target.w, target.h);
        ctx.strokeStyle = "yellow";
        ctx.strokeRect(target.x, target.y, target.w, target.h);

        // Draw Walls
        ctx.fillStyle = "#888";
        walls.forEach(w => ctx.fillRect(w.x, w.y, w.w, w.h));

        // Draw Car
        ctx.save();
        ctx.translate(car.x, car.y);
        ctx.rotate(car.angle);
        ctx.fillStyle = car.damage > 50 ? "orange" : "#3498db";
        ctx.fillRect(-car.w/2, -car.h/2, car.w, car.h);
        // Windshield to show direction
        ctx.fillStyle = "white";
        ctx.fillRect(car.w/4, -car.h/2 + 2, 5, car.h - 4);
        ctx.restore();

        update();
        requestAnimationFrame(draw);
    }
    draw();
</script>
</body>
</html>
