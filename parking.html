<!DOCTYPE html>
<html>
<head>
    <title>Parking Master 2025</title>
    <style>
        body { margin: 0; background: #1a1a1a; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }
        canvas { background: #333; border: 4px solid #444; display: none; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        #ui { position: absolute; top: 20px; color: white; text-align: center; width: 100%; pointer-events: none; z-index: 10; display: none; }
        
        /* Home Screen Styling */
        #home-screen { text-align: center; color: white; background: #2c3e50; padding: 50px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        h1 { font-size: 48px; margin-bottom: 10px; color: #f1c40f; }
        button { background: #27ae60; border: none; color: white; padding: 15px 40px; font-size: 24px; border-radius: 5px; cursor: pointer; transition: 0.3s; }
        button:hover { background: #2ecc71; transform: scale(1.05); }
    </style>
</head>
<body>

    <!-- Home Screen -->
    <div id="home-screen">
        <h1>PARKING FURY 2025</h1>
        <p>Use <b>WASD</b> to drive. Park in the yellow zone.</p>
        <button onclick="startGame()">START GAME</button>
    </div>

    <!-- Game UI -->
    <div id="ui">
        <h2 id="level-tag">Level 1</h2>
        <p>Damage: <span id="damage">0</span>%</p>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const homeScreen = document.getElementById("home-screen");
    const ui = document.getElementById("ui");
    
    canvas.width = 800;
    canvas.height = 600;

    let currentLevel = 0;
    let gameActive = false;

    // Game Objects
    const car = { x: 0, y: 0, angle: 0, speed: 0, accel: 0.15, friction: 0.96, turnSpeed: 0.04, w: 40, h: 20, damage: 0 };
    const keys = {};

    // 5 Progressive Levels
    const levels = [
        { // Level 1: Straight Ahead
            start: {x: 100, y: 300, a: 0},
            target: {x: 650, y: 280, w: 60, h: 40},
            walls: [{x: 0, y: 0, w: 800, h: 20}, {x: 0, y: 580, w: 800, h: 20}]
        },
        { // Level 2: The U-Turn
            start: {x: 100, y: 100, a: 0},
            target: {x: 100, y: 450, w: 60, h: 40},
            walls: [{x: 0, y: 250, w: 600, h: 100}]
        },
        { // Level 3: Tight Squeeze
            start: {x: 50, y: 50, a: 0},
            target: {x: 700, y: 500, w: 60, h: 40},
            walls: [{x: 200, y: 0, w: 50, h: 450}, {x: 450, y: 150, w: 50, h: 450}]
        },
        { // Level 4: The Garage
            start: {x: 400, y: 500, a: -Math.PI/2},
            target: {x: 375, y: 50, w: 50, h: 80},
            walls: [{x: 0, y: 150, w: 350, h: 20}, {x: 450, y: 150, w: 350, h: 20}, {x: 0, y: 0, w: 20, h: 600}, {x: 780, y: 0, w: 20, h: 600}]
        },
        { // Level 5: Zig-Zag
            start: {x: 50, y: 500, a: 0},
            target: {x: 700, y: 50, w: 60, h: 40},
            walls: [{x: 150, y: 300, w: 500, h: 50}, {x: 0, y: 150, w: 500, h: 50}]
        }
    ];

    function startGame() {
        homeScreen.style.display = "none";
        canvas.style.display = "block";
        ui.style.display = "block";
        loadLevel(0);
        gameActive = true;
        draw();
    }

    function loadLevel(idx) {
        if (idx >= levels.length) {
            alert("CONGRATULATIONS! You are a Parking Pro!");
            location.reload();
            return;
        }
        currentLevel = idx;
        const l = levels[idx];
        car.x = l.start.x; car.y = l.start.y; car.angle = l.start.a;
        car.speed = 0; car.damage = 0;
        document.getElementById("damage").innerText = "0";
        document.getElementById("level-tag").innerText = "Level " + (idx + 1);
    }

    window.addEventListener("keydown", e => keys[e.code] = true);
    window.addEventListener("keyup", e => keys[e.code] = false);

    function update() {
        if (!gameActive) return;

        // WASD Controls
        if (keys["KeyW"]) car.speed += car.accel;
        if (keys["KeyS"]) car.speed -= car.accel;
        
        if (Math.abs(car.speed) > 0.1) {
            const dir = car.speed > 0 ? 1 : -1;
            if (keys["KeyA"]) car.angle -= car.turnSpeed * dir;
            if (keys["KeyD"]) car.angle += car.turnSpeed * dir;
        }

        car.speed *= car.friction;
        car.x += Math.cos(car.angle) * car.speed;
        car.y += Math.sin(car.angle) * car.speed;

        // Wall Collision
        levels[currentLevel].walls.forEach(w => {
            if (car.x > w.x && car.x < w.x + w.w && car.y > w.y && car.y < w.y + w.h) {
                car.speed = -car.speed * 1.2;
                car.damage += 2;
                document.getElementById("damage").innerText = Math.floor(car.damage);
                if (car.damage >= 100) {
                    alert("Car Wrecked! Restarting level...");
                    loadLevel(currentLevel);
                }
            }
        });

        // Win Condition
        const t = levels[currentLevel].target;
        if (car.x > t.x && car.x < t.x + t.w && car.y > t.y && car.y < t.y + t.h && Math.abs(car.speed) < 0.2) {
            currentLevel++;
            loadLevel(currentLevel);
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const l = levels[currentLevel];

        // Draw Walls
        ctx.fillStyle = "#555";
        l.walls.forEach(w => ctx.fillRect(w.x, w.y, w.w, w.h));

        // Draw Target
        ctx.fillStyle = "rgba(241, 196, 15, 0.4)";
        ctx.fillRect(l.target.x, l.target.y, l.target.w, l.target.h);
        ctx.strokeStyle = "#f1c40f";
        ctx.lineWidth = 3;
        ctx.strokeRect(l.target.x, l.target.y, l.target.w, l.target.h);

        // Draw Car
        ctx.save();
        ctx.translate(car.x, car.y);
        ctx.rotate(car.angle);
        ctx.fillStyle = "#e74c3c"; // Red Car
        ctx.fillRect(-car.w/2, -car.h/2, car.w, car.h);
        ctx.fillStyle = "white"; // Headlights
        ctx.fillRect(car.w/2 - 5, -car.h/2 + 2, 5, 5);
        ctx.fillRect(car.w/2 - 5, car.h/2 - 7, 5, 5);
        ctx.restore();

        update();
        requestAnimationFrame(draw);
    }
</script>
</body>
</html>
