<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cookie Clicker 2.052 Full Engine</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: 'Tahoma', sans-serif; display: flex; height: 100vh; margin: 0; }
        #left-panel { width: 30%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #222; border-right: 5px solid #444; position: relative; }
        #right-panel { width: 70%; display: flex; flex-direction: column; background: #333; }
        .section-title { background: #444; padding: 10px; font-weight: bold; text-align: center; border-bottom: 2px solid #555; }
        #upgrade-grid { display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; min-height: 60px; background: #222; border-bottom: 5px solid #444; }
        .upgrade-icon { width: 45px; height: 45px; background: #666; border: 2px solid #f1c40f; cursor: pointer; display: flex; align-items: center; justify-content: center; border-radius: 4px; }
        #shop-scroll { overflow-y: auto; flex-grow: 1; padding: 10px; }
        .building { background: #444; margin-bottom: 5px; padding: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-radius: 4px; }
        .building.disabled { opacity: 0.5; filter: grayscale(1); cursor: not-allowed; }
        #cookie { font-size: 120px; cursor: pointer; transition: transform 0.05s; background: none; border: none; }
        .golden-cookie { position: absolute; font-size: 50px; cursor: pointer; z-index: 100; animation: fade 10s forwards; }
        @keyframes fade { from { opacity: 1; } to { opacity: 0; } }
        .prestige-bar, .pantheon-bar { background: #4a148c; padding: 10px; text-align: center; font-weight: bold; color: #ea80fc; }
        button.ascend { background: #7b1fa2; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 3px; }
        .pantheon-slot { border: 2px dashed #f1c40f; width: 60px; height: 60px; margin: 5px; display: inline-block; text-align: center; line-height: 60px; }
    </style>
</head>
<body>

<div id="left-panel">
    <div id="prestige-info" class="prestige-bar" style="width:100%; position:absolute; top:0;">
        Chips: <span id="chips">0</span> (+<span id="pending-chips">0</span>) 
        <button class="ascend" onclick="ascend()">Ascend</button>
    </div>
    <h1 id="cookie-display" style="margin-top:50px;">0</h1>
    <p>per second: <span id="cps-display">0</span></p>
    <button id="cookie">üç™</button>
    <div id="buff-display" style="color:#f1c40f; font-weight:bold;"></div>
</div>

<div id="right-panel">
    <div class="section-title">Upgrades</div>
    <div id="upgrade-grid"></div>
    
    <div class="section-title">Buildings</div>
    <div id="shop-scroll"></div>

    <div id="pantheon" style="display:none;">
        <div class="section-title">Pantheon (Temple Lv. 1)</div>
        <div style="text-align: center;">
            <div id="slot-0" class="pantheon-slot" onclick="slotSpirit(0)" title="Ruby Slot (Strongest effect)"></div>
            <div id="slot-1" class="pantheon-slot" onclick="slotSpirit(1)" title="Diamond Slot (Medium effect)"></div>
            <div id="slot-2" class="pantheon-slot" onclick="slotSpirit(2)" title="Jade Slot (Weakest effect)"></div>
        </div>
    </div>
</div>

<script>
    let cookies = 0;
    let allTimeCookies = 0;
    let totalCps = 0;
    let heavenlyChips = 0;
    let frenzyMult = 1;
    let buildingMult = 1; // Pantheon Mokalsium effect
    let clickMult = 1; // Pantheon Muridal effect
    
    const buildingData = [
        {name: "Cursor", cost: 15, cps: 0.1, icon: "üñ±Ô∏è"}, {name: "Grandma", cost: 100, cps: 1, icon: "üëµ"},
        {name: "Farm", cost: 1100, cps: 8, icon: "üöú"}, {name: "Mine", cost: 12000, cps: 47, icon: "‚õèÔ∏è"},
        {name: "Factory", cost: 130000, cps: 260, icon: "üè≠"}, {name: "Bank", cost: 1400000, cps: 1400, icon: "üè¶"},
        {name: "Temple", cost: 20000000, cps: 7800, icon: "üèõÔ∏è"}, {name: "Wizard Tower", cost: 330000000, cps: 44000, icon: "üßô"},
        {name: "Shipment", cost: 5100000000, cps: 260000, icon: "üöÄ"}, {name: "Alchemy Lab", cost: 75000000000, cps: 1600000, icon: "‚öóÔ∏è"},
        {name: "Portal", cost: 1000000000000, cps: 10000000, icon: "üåÄ"}, {name: "Time Machine", cost: 14000000000000, cps: 65000000, icon: "‚åõ"},
        {name: "Antimatter Condenser", cost: 170000000000000, cps: 430000000, icon: "‚öõÔ∏è"}, {name: "Prism", cost: 2100000000000000, cps: 2900000000, icon: "üåà"},
        {name: "Chancemaker", cost: 26000000000000000, cps: 21000000000, icon: "üçÄ"}, {name: "Fractal Engine", cost: 310000000000000000, cps: 150000000000, icon: "‚ùÑÔ∏è"},
        {name: "JavaScript Console", cost: 7100000000000000000, cps: 1100000000000, icon: "üíª"}, {name: "Idleverse", cost: 12000000000000000000000, cps: 8300000000000, icon: "üåå"},
        {name: "Cortex Baker", cost: 1900000000000000000000000, cps: 64000000000000, icon: "üß†"}, {name: "You", cost: 540000000000000000000000000, cps: 510000000000000, icon: "üë§"}
    ];

    let buildings = buildingData.map(b => ({...b, count: 0, mult: 1}));
    let pantheonSlots = [null, null, null]; // Stores spirit ID

    // System: Pantheon Spirits (Simplified with effects based on slot index 0=Ruby, 2=Jade)
    const spirits = [
        {id: 'Mokalsium', name: 'Mokalsium, Mother Spirit', effect: (slot) => { buildingMult = [1.10, 1.05, 1.03][slot]; }, unEffect: () => { buildingMult = 1; }},
        {id: 'Muridal', name: 'Muridal, Spirit of Labor', effect: (slot) => { clickMult = [1.15, 1.10, 1.05][slot]; }, unEffect: () => { clickMult = 1; }},
        {id: 'Godzamok', name: 'Godzamok, Spirit of Ruin', effect: (slot) => { /* Complex sell building buff not implemented here */ alert("Godzamok slotted, but selling buildings functionality is complex and not included."); }, unEffect: () => {}}
    ];

    function slotSpirit(slotIndex) {
        // Simple UI prompt for which spirit to slot
        const spiritId = prompt(`Enter spirit ID to slot in slot ${slotIndex} (Mokalsium, Muridal, Godzamok):`);
        const spirit = spirits.find(s => s.id === spiritId);
        if (spirit) {
            // Un-effect previous spirit if any
            if (pantheonSlots[slotIndex]) {
                const prevSpirit = spirits.find(s => s.id === pantheonSlots[slotIndex]);
                if (prevSpirit) prevSpirit.unEffect();
            }
            pantheonSlots[slotIndex] = spirit.id;
            spirit.effect(slotIndex);
            document.getElementById(`slot-${slotIndex}`).innerText = spirit.id;
        } else if (spiritId === "") {
            // Unslot spirit
            if (pantheonSlots[slotIndex]) {
                const prevSpirit = spirits.find(s => s.id === pantheonSlots[slotIndex]);
                if (prevSpirit) prevSpirit.unEffect();
            }
            pantheonSlots[slotIndex] = null;
            document.getElementById(`slot-${slotIndex}`).innerText = "";
        }
    }

    // Engine: Loop & UI
    function loop() {
        let prestigeMult = 1 + (heavenlyChips * 0.01);
        // Integrate buildingMult from Pantheon
        totalCps = buildings.reduce((sum, b) => sum + (b.count * b.cps * b.mult * buildingMult), 0) * prestigeMult * frenzyMult;
        cookies += (totalCps / 10);
        allTimeCookies += (totalCps / 10);
        
        document.getElementById('cookie-display').innerText = format(cookies);
        document.getElementById('cps-display').innerText = format(totalCps);
        document.getElementById('chips').innerText = heavenlyChips;
        document.getElementById('pending-chips').innerText = Math.max(0, getChipsAt(allTimeCookies) - heavenlyChips);
        
        updateShopAffordabilityAndTiers();

        // Check if Pantheon should be visible (Temple index is 6)
        if (buildings[6].count > 0) document.getElementById('pantheon').style.display = 'block';

        setTimeout(loop, 100);
    }

    // System: Visual Tiers & Affordability
    function updateShopAffordabilityAndTiers() {
        buildings.forEach((b, i) => {
            let cost = Math.ceil(b.cost * Math.pow(1.15, b.count));
            const el = document.getElementById(`b-${i}`);
            if(el) {
                el.classList.toggle('disabled', cookies < cost);
                let tierIcon = 'üç™'; // Default
                if (b.count >= 50) tierIcon = 'ü•à';
                if (b.count >= 100) tierIcon = 'ü•á';
                if (b.count >= 200) tierIcon = 'üíé';
                el.innerHTML = `<span>${tierIcon} <b>${b.name}</b> x${b.count}</span> <span class="cost">${format(cost)}</span>`;
            }
        });
    }

    // Helper Functions (Buy, Ascend, Golden Cookie, Format, etc. from previous response remain the same)
    // ... (Keep existing buyBuilding, getChipsAt, ascend, spawnGoldenCookie, init functions here)

    // Code below is copy-pasted from the previous response's <script> body
    function getChipsAt(cookies) { return Math.floor(Math.pow(cookies / 1e12, 1/3)); }
    function ascend() {
        let pending = getChipsAt(allTimeCookies) - heavenlyChips;
        if(pending < 1) return alert("You need more cookies to earn Heavenly Chips!");
        if(confirm(`Ascend? You will gain ${pending} Heavenly Chips but lose your current cookies and buildings.`)) {
            heavenlyChips += pending;
            cookies = 0;
            buildings.forEach(b => { b.count = 0; b.mult = 1; });
            // purchasedUpgrades = []; // Need save system for upgrades
            // saveGame(); // need save function
            renderBuildings();
        }
    }
    function spawnGoldenCookie() {
        const gc = document.createElement('div');
        gc.className = 'golden-cookie';
        gc.innerHTML = '‚ú®üç™‚ú®';
        gc.style.left = Math.random() * 80 + '%';
        gc.style.top = Math.random() * 80 + '%';
        gc.onclick = () => {
            frenzyMult = 7;
            document.getElementById('buff-display').innerText = "FRENZY (x7) - 77s";
            setTimeout(() => { frenzyMult = 1; document.getElementById('buff-display').innerText = ""; }, 77000);
            gc.remove();
        };
        document.getElementById('left-panel').appendChild(gc);
        setTimeout(() => gc.remove(), 10000);
    }
    setInterval(() => { if(Math.random() < 0.05) spawnGoldenCookie(); }, 10000);
    function buyBuilding(i) {
        let b = buildings[i];
        let cost = Math.ceil(b.cost * Math.pow(1.15, b.count));
        if (cookies >= cost) { cookies -= cost; b.count++; renderBuildings(); }
    }
    function renderBuildings() {
        const shop = document.getElementById('shop-scroll');
        shop.innerHTML = '';
        buildings.forEach((b, i) => {
            let cost = Math.ceil(b.cost * Math.pow(1.15, b.count));
            const div = document.createElement('div');
            div.className = `building`;
            div.id = `b-${i}`;
            div.onclick = () => buyBuilding(i);
            shop.appendChild(div);
        });
    }
    function format(n) {
        if (n >= 1e15) return (n/1e15).toFixed(2) + " Quad";
        if (n >= 1e12) return (n/1e12).toFixed(2) + " Trill";
        if (n >= 1e9) return (n/1e9).toFixed(2) + " Bill";
        if (n >= 1e6) return (n/1e6).toFixed(2) + " Mill";
        return Math.floor(n).toLocaleString();
    }
    document.getElementById('cookie').onclick = () => { cookies += 1 * clickMult; allTimeCookies += 1 * clickMult; };
    renderBuildings();
    loop();
</script>
</body>
</html>
